#!/bin/bash -xv
set -e

#SBATCH --job-name=rl_train
#SBATCH --output=/home-mscluster/abrickhill/research/RR/cluster/result_%j.txt
#SBATCH --error=/home-mscluster/abrickhill/research/RR/cluster/error_%j.txt
#SBATCH --ntasks=8
#SBATCH --time=72:00:00
#SBATCH --partition=bigbatch

export MUJOCO_GL="egl"

# Run 8 processes in parallel, each with its own output file
for i in {1..10}; do
    python3 -u ../environment/trainwandbViolation.py 2>&1 > /home-mscluster/abrickhill/research/RR/cluster/output_$i.txt || echo "Process $i failed with exit code $?" >> /home-mscluster/abrickhill/research/RR/cluster/error_summary.txt &
    python3 -u ../environment/trainwandb.py 2>&1 > /home-mscluster/abrickhill/research/RR/cluster/output_$i.txt || echo "Process $i failed with exit code $?" >> /home-mscluster/abrickhill/research/RR/cluster/error_summary.txt &
done

wait  # Wait for all background processes to finish